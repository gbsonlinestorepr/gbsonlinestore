<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="rating_static">
            <div class="o_website_rating_static">
                <t t-set="val" t-value="product.get_rating()"/>
                <t t-foreach="range(0, val.get('val_integer'))" t-as="num">
                    <i class="fa fa-star"></i>
                </t>
                <t t-if="val.get('val_decimal')">
                    <i class="fa fa-star-half-o"></i>
                </t>
                <t t-foreach="range(0, val.get('empty_star'))" t-as="num">
                    <i class="fa fa-star-o"></i>
                </t>
            </div>
        </template>

        <template id="product" inherit_id="website_sale.product">
            <t t-call="website_sale.search" position="replace"/>
            <t t-call="website_sale.pricelist_list" position="replace"/>
            <t t-call="website_sale.product_price" position="replace"/>
            <xpath expr="//section//div//div[hasclass('col-sm-4')]" position="attributes">
                <attribute name="class">col-md-12</attribute>
            </xpath>
            <xpath expr="//section//div//div//ol" position="attributes">
                <attribute name="class">breadcrumb breadcrumb-gbs</attribute>
            </xpath>

            <xpath expr="//section//div[hasclass('row')][2]" position="attributes">
                <attribute name="class">row product-single</attribute>
            </xpath>



            <xpath expr="//section//div//div[hasclass('col-sm-7')]" position="replace">
                <div class="col-sm-7">
                    <span itemprop="image"
                          t-attf-content="{{request.httprequest.url_root}}web/image/product.template/{{product.id}}/image"
                          t-field="product.image"
                          t-options="{'widget': 'image', 'class': 'product_detail_img', 'alt-field': 'name', 'zoom': 'image'}"
                          groups="!website_sale.group_website_multi_image"/>
                    <t groups="website_sale.group_website_multi_image">
                        <t t-set="variant_img" t-value="product.product_variant_id.image_variant"/>
                        <t t-set="image_ids" t-value="product.product_image_ids"/>
                        <div id="o-carousel-product" class="carousel slide" data-ride="carousel" data-interval="0">
                            <div class="col-md-2" t-if="len(image_ids) or variant_img">
                                <div data-target="#o-carousel-product" data-slide-to="0"
                                     class="active img-thumbnail mb-2">
                                    <img class="img img-responsive js_variant_img_small"
                                         t-attf-src="/website/image/product.template/{{product.id}}/image/90x90"
                                         t-att-alt="product.name"/>
                                </div>
                                <div t-if="variant_img" data-target="#o-carousel-product" data-slide-to="1"
                                     class="img-thumbnail mb-2">
                                    <img class="img img-responsive"
                                         t-attf-src="/website/image/product.product/{{product.product_variant_id.id}}/image/90x90"
                                         t-att-alt="product.name"/>
                                </div>
                                <t t-if="len(image_ids)" t-foreach="image_ids" t-as="pimg">
                                    <div data-target="#o-carousel-product"
                                         t-att-data-slide-to="pimg_index + (variant_img and 2 or 1)"
                                         class="img-thumbnail mb-2">
                                        <img class="img img-responsive"
                                             t-attf-src="/website/image/product.image/{{pimg.id}}/image/90x90"
                                             t-att-alt="pimg.name"/>
                                    </div>
                                </t>
                            </div>
                            <div class="col-md-10">
                                <div class="carousel-inner">
                                    <div class="item active" itemprop="image" t-field="product.image"
                                         t-options="{'widget': 'image', 'class': 'product_detail_img js_variant_img', 'alt-field': 'name', 'zoom': 'image', 'unique': product['__last_update']}"/>
                                    <div t-if="variant_img" class="item" itemprop="image"
                                         t-field="product.product_variant_id.image"
                                         t-options="{'widget': 'image', 'class': 'product_detail_img', 'alt-field': 'name', 'zoom': 'image', 'unique': product['__last_update'] + (product.product_variant_id['__last_update'] or '')}"/>
                                    <t t-if="len(image_ids)" t-foreach="image_ids" t-as="pimg">
                                        <div class="item" t-field="pimg.image"
                                             t-options='{"widget": "image", "class": "product_detail_img", "alt-field": "name", "zoom": "image" }'/>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </t>

                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a data-toggle="tab" role="tab" href="#product_notebook_description">Description</a>
                        </li>
                        <li class="">
                            <a data-toggle="tab" role="tab" href="#product_notebook_aditional">Additional Information</a>
                        </li>
                    </ul>
                    <div class="tab-content nav nav-tabs">
                        <div id="product_notebook_description" class="tab-pane active">
                            <div class="o_not_editable">
                                <p t-field="product.description_sale" class="text-muted"/>
                            </div>
                        </div>

                        <div id="product_notebook_aditional" class="tab-pane">
                            <div class="o_not_editable">
                                <span></span>
                            </div>
                        </div>

                    </div>
                </div>

            </xpath>

            <xpath expr="//section//div//div[hasclass('col-sm-5')]//h1" position="after">
                <t t-call="website_gbs.rating_static"/>
                <t t-call="website_sale.product_price"/>
            </xpath>
            <xpath expr="//section//div//div[hasclass('col-sm-5')]//hr" position="replace">
                <t t-call="website_gbs.recommended_products"/>
            </xpath>
            <xpath expr="//section//div//div[hasclass('col-sm-5')]//div[hasclass('o_not_editable')]"
                   position="attributes">
                <attribute name="class">hidden</attribute>
            </xpath>
            <xpath expr="//div//div[hasclass('container')]" position="attributes">
                <attribute name="class">container mt32 hidden</attribute>
            </xpath>
        </template>

        <template id="product_price" inherit_id="website_sale.product_price">
            <xpath expr="//div//h4//b" position="replace">
                <ins>
                    <b class="oe_price" style="white-space: nowrap;"
                       t-esc="product.website_price"
                       t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                </ins>

                <div class="oe_not_editable h5" data-oe-type="text">
                    <div class="text-muted hidden-xs" t-field="product.description_short"/>
                </div>
            </xpath>
        </template>

        <template id="products" inherit_id="website_sale.products">
            <xpath expr="//div[hasclass('products_pager')]" position="replace"/>
            <xpath expr="//div[@id='products_grid']" position="replace">
                <div class="col-md-9 col-lg-10 right nogutter">
                    <article class="on-sale">
                        <div class="card-deck no-gutters shop-product-container">
                            <tr t-foreach="bins" t-as="tr_product">
                                <t t-foreach="tr_product" t-as="td_product">
                                    <t t-if="td_product">
                                        <t t-set="product" t-value="td_product['product']"/>
                                        <div class="card col-lg-2 col-md-3 col-sd-6 card-size-fix shop-product-item">
                                            <form action="/shop/cart/update" method="post">
                                                <div>
                                                    <div class="card-img ">
                                                        <a itemprop="url"
                                                           t-att-href="keep('/shop/product/%s' % slug(product), page=(pager['page']['num'] if pager['page']['num']&gt;1 else None))">
                                                            <span itemprop="image"
                                                                  t-attf-content="{{request.httprequest.url_root}}web/image/product.template/{{product.id}}/image"
                                                                  t-field="product.image"
                                                                  t-options="{'widget': 'image', 'resize': None if product_image_big else '300x300', 'zoom': 'image'}"
                                                                  t-att-alt="product.name"/>
                                                            <!--<img class="label-sale" src="assets/images/sale-label.png"/>-->
                                                        </a>
                                                    </div>

                                                    <section class="card-body">
                                                        <h6>
                                                            <a itemprop="name"
                                                               t-att-href="keep('/shop/product/%s' % slug(product), page=(pager['page']['num'] if pager['page']['num']&gt;1 else None))"
                                                               t-att-content="product.name" t-field="product.name"/>
                                                        </h6>

                                                        <div class="row no-gutters">
                                                            <div class="text-bg col-sm-12">
                                                                <del></del>
                                                                <ins>
                                                                    <div itemprop="offers" itemscope="itemscope"
                                                                         itemtype="http://schema.org/Offer"
                                                                         class="product_price"
                                                                         t-if="product.product_variant_ids">
                                                                        <b>
                                                                            <t t-if="product.website_price_difference and website.get_current_pricelist().discount_policy=='without_discount'">
                                                                                <del class="text-danger mr8"
                                                                                     style="white-space: nowrap;"
                                                                                     t-esc="compute_currency(product.website_public_price)"
                                                                                     t-options="{'widget': 'monetary', 'display_currency': website.get_current_pricelist().currency_id, 'from_currency': website.currency_id}"/>
                                                                            </t>

                                                                            <span t-esc="product.website_price"
                                                                                  t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                                                                            <span itemprop="price" style="display:none;"
                                                                                  t-esc="product.website_price"/>
                                                                            <span itemprop="priceCurrency"
                                                                                  style="display:none;"
                                                                                  t-esc="website.currency_id.name"/>
                                                                        </b>
                                                                    </div>
                                                                </ins>
                                                            </div>
                                                            <!--<div class="star-rating col-sm-12">-->
                                                            <!--<ul class="list-inline">-->
                                                            <!--<li class="list-inline-item">-->
                                                            <!--<i class="fa fa-star"></i>-->
                                                            <!--</li>-->
                                                            <!--<li class="list-inline-item">-->
                                                            <!--<i class="fa fa-star"></i>-->
                                                            <!--</li>-->
                                                            <!--<li class="list-inline-item">-->
                                                            <!--<i class="fa fa-star"></i>-->
                                                            <!--</li>-->
                                                            <!--<li class="list-inline-item">-->
                                                            <!--<i class="far fa-star"></i>-->
                                                            <!--</li>-->
                                                            <!--<li class="list-inline-item">-->
                                                            <!--<i class="far fa-star"></i>-->
                                                            <!--</li>-->
                                                            <!--</ul>-->
                                                            <!--</div>-->
                                                            <div class="col-12">
                                                                <a class="btn btn-default btn-card"
                                                                   t-att-href="keep('/shop/product/%s' % slug(product), page=(pager['page']['num'] if pager['page']['num']&gt;1 else None))">
                                                                    See Details
                                                                </a>
                                                            </div>
                                                        </div>

                                                    </section>
                                                </div>
                                            </form>
                                        </div> <!--end .card-->
                                    </t>
                                </t>
                            </tr>
                        </div>
                    </article>
                </div>

            </xpath>
        </template>

        <template id="products_attributes" inherit_id="website_sale.products">
            <xpath expr="//div[@id='products_grid_before']" position="attributes">
                <attribute name="class">col-md-3 col-lg-2 hidden-sm</attribute>
            </xpath>
        </template>

        <template id="product_comment" inherit_id="website_sale.product_comment">
            <xpath expr="//div[hasclass('col-md-8')]" position="replace">
                <div class="col-md-8 col-md-offset-2">
                    <t t-call="portal.message_thread">
                        <t t-set="object" t-value="product"/>
                        <t t-set="display_rating" t-value="False"/>
                    </t>
                </div>
            </xpath>
        </template>

        <template id="recommended_products" customize_show="True" name="Alternative Products">
            <div class="container" t-if="product.alternative_product_ids">
                <h3>Related Products:</h3>
                <div class="row mt16" style="">
                    <t t-foreach="product.alternative_product_ids" t-as="alt_product">
                        <div class="col-md-2 thumbnail"
                             style="width: 170px; height:100%; min-height:180px; float:left; display:inline; margin-right: 10px; overflow:hidden;">
                            <div class="mt16 text-center" style="height: 100%;">
                                <div t-field="alt_product.image_small"
                                     t-options="{'widget': 'image', 'class': 'img-rounded shadow o_alternative_product' }"/>
                                <h5>
                                    <a t-attf-href="/shop/product/#{ slug(alt_product) }" style="display: block">
                                        <span t-att-title="alt_product.name" t-field="alt_product.name"
                                              style="display: block;"/>
                                    </a>
                                </h5>
                            </div>
                        </div>
                    </t>
                </div>
            </div>
        </template>

    </data>
</odoo>
